<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>å½°åŒ–ç¾é£Ÿåœ°åœ– TOP20</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#00804b">

<style>
/* æ–°å¢å°èˆªæ¬„çš„æ¨£å¼ (ä¿ç•™) */
nav {
  background: #333; /* æ·±ç°è‰²èƒŒæ™¯ */
  padding: 0.7rem 1rem;
  text-align: center;
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
}
nav a {
  color: #fff; /* ç™½è‰²æ–‡å­— */
  text-decoration: none;
  margin: 0 1rem;
  font-weight: bold;
  transition: color 0.3s;
  font-size: 1.1rem;
}
nav a:hover {
  color: #ffcc00; /* äº®é»ƒè‰² hover æ•ˆæœ */
}
/* æ–°å¢ã€Œé—œæ–¼ã€å€å¡Šçš„æ¨£å¼ */
.info-box {
  background: #fff;
  padding: 20px;
  margin-top: 30px;
  border-radius: 12px;
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
  border-left: 5px solid #00804b; /* ä¸»é¡Œè‰²è£é£¾ */
}
.info-box h2 {
  color: #00804b;
  margin-bottom: 15px;
  border-bottom: 1px solid #eee;
  padding-bottom: 5px;
}
.info-box ul {
  padding-left: 20px;
  margin-top: 10px;
}
.info-box .copyright {
    text-align: right;
    font-size: 0.9em;
    color: #666;
    margin-top: 15px;
}
/* çµæŸæ–°å¢æ¨£å¼ */


*{margin:0;padding:0;box-sizing:border-box}
body{font-family:-apple-system,"Microsoft JhengHei",sans-serif;background:#f5f5f5;color:#333;line-height:1.6}
header{background:#00804b;color:#fff;padding:1rem;text-align:center}
h1{font-size:1.5rem}

.container{max-width:1000px;margin:0 auto;padding:1rem}

/* æ§åˆ¶å€ */
.controls{background:#fff;padding:1rem;border-radius:14px;box-shadow:0 4px 20px rgba(0,0,0,.1);margin-bottom:1rem;text-align:center}
label{font-weight:bold;margin:0 .4rem}
select,input{padding:.6rem 1rem;border:1px solid #bbb;border-radius:10px;font-size:1rem;margin:.3rem}
button{padding:.7rem 1.5rem;border-radius:10px;border:none;cursor:pointer;font-size:1rem;transition:background .3s}
button:hover{background:#00663d}
.category-buttons{display:flex;justify-content:center;gap:10px;margin-top:.8rem}
.category-buttons button{background:#00804b;color:#fff;flex:1}

/* å…§å®¹å€ */
#cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:20px;padding-top:1rem}
.card{background:#fff;padding:15px;border-radius:12px;box-shadow:0 2px 10px rgba(0,0,0,.08);transition:transform .2s}
.card:hover{transform:translateY(-3px)}
.card h2{font-size:1.2rem;margin-bottom:10px;color:#00804b}
.card .item{margin-bottom:5px;font-size:.95rem}
.card a{color:#00804b;text-decoration:none;font-weight:bold}
.card a:hover{text-decoration:underline}
.google-rating{font-size:1.2rem;font-weight:bold;color:#e74c3c;margin-top:5px}
</style>
</head>
<body>
<header><h1>å½°åŒ–ç¾é£Ÿåœ°åœ– TOP20</h1></header>

<nav>
  <a href="#home">ğŸŒŸ é¦–é </a>
  <a href="#controls">ğŸ” ç¯©é¸</a>
  <a href="#about">â„¹ï¸ é—œæ–¼</a>
</nav>
<div class="container">
  <div class="controls" id="controls">
    <label for="keyword">æœå°‹åº—å®¶/ç‰¹è‰²ï¼š</label>
    <input type="text" id="keyword" placeholder="è«‹è¼¸å…¥é—œéµå­—" oninput="render()">
    
    <label>é¡åˆ¥ï¼š</label>
    <div class="category-buttons">
      <button data-cat="kongroufan">çˆŒè‚‰é£¯</button>
      <button data-cat="rouyuan">è‚‰åœ“</button>
      <button data-cat="sushi">ç´ é£Ÿéºµ</button>
      <button data-cat="">å…¨éƒ¨</button>
    </div>
    
    <label for="districtFilter">åœ°å€ï¼š</label>
    <select id="districtFilter" onchange="render()">
      <option value="">å…¨éƒ¨åœ°å€</option>
    </select>
  </div>
  <div id="cards"></div> 

  <div id="about" class="info-box">
    <h2>â„¹ï¸ é—œæ–¼é€™å€‹å½°åŒ–ç¾é£Ÿåœ°åœ–</h2>
    <p>é€™å€‹ PWA æ˜¯ç‚ºäº†å±•ç¤ºå½°åŒ–ç¸£çš„ç‰¹è‰²ç¾é£Ÿï¼š**çˆŒè‚‰é£¯ã€è‚‰åœ“å’Œç´ é£Ÿéºµ**ï¼Œä¸¦å¹«åŠ©æ‚¨å¿«é€Ÿæ‰¾åˆ°å„åœ°å€é«˜è©•åƒ¹çš„åº—å®¶ã€‚</p>
    <p>æ‰€æœ‰è³‡æ–™çš†ç‚ºä½œè€…åƒè€ƒ Google è©•è«–å’Œåœ¨åœ°äººæ¨è–¦ï¼Œæ‰‹å·¥å½™æ•´çš„åº—å®¶æ¸…å–®ã€‚æ¯å€‹å“é …/åœ°å€æœ€å¤šé¡¯ç¤º **TOP 20** è©•åˆ†æœ€é«˜çš„åº—å®¶ã€‚</p>
    <h3>è³‡æ–™ä¾†æºèˆ‡å…è²¬è²æ˜ï¼š</h3>
    <ul>
      <li>**è³‡æ–™çœŸå¯¦æ€§**ï¼šåº—å®¶åç¨±ã€é›»è©±èˆ‡åœ°å€çš†ç¶“éç¶²è·¯æŸ¥è­‰ã€‚</li>
      <li>**è©•åˆ†ä¾æ“š**ï¼šGoogle è©•åˆ† (Google æ¬„ä½)ã€‚</li>
      <li>**ç‰ˆæ¬Šè²æ˜**ï¼šæœ¬ç¨‹å¼ç¢¼èˆ‡è³‡æ–™é›†åƒ…ä¾›å€‹äººå­¸ç¿’èˆ‡ PWA å¯¦ä½œåƒè€ƒã€‚</li>
    </ul>
    <p class="copyright">è£½ä½œæ—¥æœŸï¼š2025.11</p>
  </div>
  </div>

<script src="data.js"></script>

<script>
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('/sw.js')
      .then(registration => {
        console.log('SW registered: ', registration);
      })
      .catch(registrationError => {
        console.log('SW registration failed: ', registrationError);
      });
  });
}
</script>
<script>
// æ¨¡ç³Šæœå°‹å‡½å¼
function fuzzyMatch(text, keyword) {
    if (!text) return false;
    return text.toLowerCase().includes(keyword.toLowerCase());
}

// è®Šæ•¸åå·²ä¿®æ­£ç‚º data (å°å¯«) ä»¥åŒ¹é… data.js
const districtSet = new Set(data.map(x => x.district)); 
const districtFilter = document.getElementById("districtFilter");

// å¡«å……åœ°å€é¸é …
districtSet.forEach(d => {
  const opt = document.createElement("option");
  opt.value = d;
  opt.textContent = d;
  districtFilter.appendChild(opt);
});

let currentCategory = "";
render(); // åˆå§‹æ¸²æŸ“

// é¡åˆ¥æŒ‰éˆ•äº‹ä»¶
document.querySelectorAll(".category-buttons button").forEach(btn => {
  btn.addEventListener("click", () => {
    currentCategory = btn.dataset.cat;
    // é‡è¨­æœå°‹é—œéµå­—
    document.getElementById("keyword").value = "";
    // å°‡é¸å–®è·³å›å…¨éƒ¨åœ°å€
    districtFilter.value = "";
    render();
  });
});

// ç¯©é¸/æœå°‹äº‹ä»¶ç›£è½
document.getElementById("keyword").addEventListener("input", render);
districtFilter.addEventListener("change", render);

function render() {
  const district = districtFilter.value;
  const category = currentCategory;
  const keyword = document.getElementById("keyword").value.trim();

  let list = data.slice();

  // ä¾åœ°å€
  if (district) list = list.filter(i => i.district === district);

  // ä¾é¡åˆ¥
  if (category) list = list.filter(i => i.category === category);

  // æ¨¡ç³Šæœå°‹ (å¤šæ¬„ä½)
  if (keyword) {
    list = list.filter(i =>
      fuzzyMatch(i.name, keyword) ||
      fuzzyMatch(i.dish, keyword) ||
      fuzzyMatch(i.address, keyword) ||
      fuzzyMatch(i.feature, keyword) ||
      fuzzyMatch(i.phone, keyword)
    );
  }

  // æ’åº TOP20
  list = list.sort((a, b) => b.google - a.google).slice(0, 20);

  const box = document.getElementById("cards");
  box.innerHTML = "";

  if (list.length === 0) {
      box.innerHTML = `<h3 style="text-align:center; padding:20px; color:#e74c3c;">âš ï¸ æŠ±æ­‰ï¼Œæ­¤æ¢ä»¶ä¸‹æ²’æœ‰æ‰¾åˆ°åº—å®¶ã€‚è«‹å˜—è©¦æ›´æ›ç¯©é¸æ¢ä»¶ã€‚</h3>`;
      return;
  }

  list.forEach((i, idx) => {
    // ä¿®æ­£ Google Maps é€£çµï¼Œä½¿ç”¨çœŸå¯¦çš„ Google Maps URL
    const mapUrl = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(i.name + " " + i.address)}`;

    const card = document.createElement("div");
    card.className = "card";

    card.innerHTML = `
      <h2>${idx + 1}. ${i.name}</h2>
      <div class="item"><b>åœ°å€ï¼š</b>${i.district}</div>
      <div class="item"><b>æ‹›ç‰Œï¼š</b>${i.dish}</div>
      <div class="item"><b>ç‰¹è‰²ï¼š</b>${i.feature}</div>
      <div class="item"><b>ç‡Ÿæ¥­æ™‚é–“ï¼š</b>${i.time}</div>
      <div class="item"><b>åƒ¹ä½ï¼š</b>${i.price}</div>
      <div class="item google-rating">Google è©•åˆ†ï¼š${i.google} â­</div>
      <div class="item"><a href="tel:${i.phone}">ğŸ“ è¯çµ¡åº—å®¶ (${i.phone})</a></div>
      <div class="item"><a href="${mapUrl}" target="_blank">ğŸ“ æŸ¥çœ‹åœ°åœ– (${i.address})</a></div>
    `;
    box.appendChild(card);
  });
}
</script>
</body>
</html>
