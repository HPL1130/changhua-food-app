<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>彰化美食地圖 TOP20</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#00804b">

<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:-apple-system,"Microsoft JhengHei",sans-serif;background:#f5f5f5;color:#333;line-height:1.6}
header{background:#00804b;color:#fff;padding:1rem;text-align:center}
h1{font-size:1.5rem}

.container{max-width:1000px;margin:0 auto;padding:1rem}
.controls{background:#fff;padding:1rem;border-radius:14px;box-shadow:0 4px 20px rgba(0,0,0,.1);margin-bottom:1rem;text-align:center}
label{font-weight:bold;margin:0 .4rem}
select{padding:.6rem 1rem;border:1px solid #bbb;border-radius:10px;font-size:1rem;margin:.3rem}
button{padding:.7rem 1.5rem;border-radius:10px;background:#00804b;color:#fff;border:none;cursor:pointer;font-size:1rem;font-weight:bold;margin-top:.5rem}

/* 卡片列表 */
#cards{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:1rem;margin-top:1rem}
.card{background:#fff;border-radius:16px;padding:1rem;box-shadow:0 6px 16px rgba(0,0,0,.1);transition:.2s}
.card:hover{transform:translateY(-3px);box-shadow:0 10px 22px rgba(0,0,0,.15)}
.card h2{font-size:1.2rem;margin-bottom:.3rem;color:#00804b}
.item{margin:.2rem 0}
.item b{color:#000}

@media(max-width:500px){
  #cards{grid-template-columns:1fr}
}
</style>
</head>

<body>
<header><h1>彰化美食地圖 TOP20</h1></header>

<div class="container">

  <div class="controls">
    <label>地區：</label>
    <select id="districtFilter">
      <option value="">全部地區</option>
    </select>

    <label>類別：</label>
    <select id="categoryFilter">
      <option value="">全部</option>
      <option value="sushi">素食麵</option>
      <option value="rouyuan">肉圓</option>
      <option value="kongroufan">爌肉飯</option>
    </select>

    <button onclick="render()">查詢</button>
  </div>

  <div id="cards"></div>

</div>

<script src="data.js"></script>
<script>
// 初始化地區
function initFilters() {
  const set = new Set();
  DATA.forEach(i => set.add(i.district));
  const sel = document.getElementById("districtFilter");
  set.forEach(d => {
    const opt=document.createElement("option");
    opt.value=d; opt.textContent=d;
    sel.appendChild(opt);
  });
}

// 渲染卡片
function render() {
  const district=document.getElementById("districtFilter").value;
  const category=document.getElementById("categoryFilter").value;

  let list=DATA;

  if(district) list=list.filter(i=>i.district===district);
  if(category) list=list.filter(i=>i.category===category);

  list=list.sort((a,b)=>b.google-a.google).slice(0,20);

  const box=document.getElementById("cards");
  box.innerHTML="";

  list.forEach((i,idx)=>{
    const card=document.createElement("div");
    card.className="card";
    card.innerHTML=`
      <h2>${idx+1}. ${i.name}</h2>
      <div class="item"><b>地區：</b>${i.district}</div>
      <div class="item"><b>招牌：</b>${i.dish}</div>
      <div class="item"><b>Google：</b>${i.google}</div>
      <div class="item"><b>時間：</b>${i.time}</div>
      <div class="item"><b>電話：</b>${i.phone}</div>
      <div class="item"><b>地址：</b>${i.address}</div>
    `;
    box.appendChild(card);
  });
}

initFilters();
render();

// 啟動 SW
if('serviceWorker' in navigator){
  navigator.serviceWorker.register('./sw.js');
}
</script>

</body>
</html>
